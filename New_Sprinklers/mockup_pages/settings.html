<meta name="viewport" content="width=device-width, initial-scale=1" user-scalable=no>
<style>
svg{
	padding:.5rem;
}
html{
	font-size:4vw;
}
@media screen and (min-width: 700px){
	html {
	    font-size: 35px;
	}
}
#pwdiv{
	padding:.5rem;
	position:fixed;
	left:5%;
	right:5%;
	top:25%;
	background:white;
	border:solid black 1px;
	box-shadow:5px 5px 15px;
}
button{
		border-radius:10px;
		border:solid black 1px;
		font-weight:bold;
		margin:.3rem;
		padding:.2rem;
}
input:hover, select:hover{
	background:rgba(240,240,255,1);
}
svg:hover{
	transform:scale(1.2);
	}
input,select{
}
*{	
	font-family:sans-serif;
	font-size:1rem;
	border-radius:5px;
}



</style>

<html>
<table style=text-align:center;margin:auto;width:100%;margin-bottom:1rem;><tr>
<td> <svg onclick='navigate("/index.html")' width=2rem viewBox="0 0 24 24" ><path d="M0 0h24v24H0V0z" fill="none"/><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z"/></svg></td>
<td style=font-size:1.5rem;font-weight:bold;>Sprinkler Settings</td>
<td><svg onclick='navigate("/scheduleSetup.html")' width=2rem viewBox="0 0 24 24" ><path d="M0 0h24v24H0V0z" fill="none"/><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm-.22-13h-.06c-.4 0-.72.32-.72.72v4.72c0 .35.18.68.49.86l4.15 2.49c.34.2.78.1.98-.24.21-.34.1-.79-.25-.99l-3.87-2.3V7.72c0-.4-.32-.72-.72-.72z"/></svg></td>
</tr></table>
<div id=pwdiv style="display:none">
	<table style=text-align:center;margin:auto;><tr>
					<td colspan=2><b>Password Settings</b></td>
			</tr><tr>
					<td>Password</td><td><input placeholder=Password type=password id=pw1></td>
			</tr><tr>
					<td>Password</td><td><input placeholder="Reenter Password" type=password id=pw2></td>
			</tr><tr>
					<td>Password Timeout(minutes)</td><td><input placeholder="Password Timeout" type=number id=timeout value=0></td>
			</tr><tr>
					<td colspan=2><button onclick=transmit("SetPassword",[pw1.value,pw2.value,timeout.value]);pwdiv.style.display="none";>Save</button><button onclick=pwdiv.style.display="none">Cancel</button></td>
	</table>
</div>
<div style=display:none id=message>
</div>
<div style=text-align:center;>
		<b>Sprinkler Password</b><br>
		<button onclick=pwdiv.style.display="">Set Password</button><br>
		<br><br>
		<b>Wireless Access Point</b><br>
		Hide Access Point? <select id=APVisibility><option selected value=0>Visible</option><option value=1>Hidden</option></select><br>
		SSID<input placeholder="Wifi SSID" id=ssid><br><button onclick=transmit("AP",[ssid.value,APVisibility.value])>Save</button><br><br><br>
		<b>Firmware Update</b><br>
		Source<input type=text id=source value=jeffshomesite.com><br><button onclick=transmit("Update",[source.value]);>Update</button><br>
<br><br>
<b>Reboot Device</b><br>
<button onclick=transmit("reboot")>Reboot</button>
<br><br>
<b>Full Reset</b><br>
<button onclick=transmit("Reset");>Reset</button>
</div>
</html>


<script>
ssid.value=SSID;
function navigate(url){
	location=url;
}

function transmit(command,values){
	var packet;
	if (command=="AP"){
			if (!values[0]){values[0]=SSID;}
			packet="id=AP&ssid="+values[0]+"&hidden="+values[1];
	}
	else if (command=="Reset"){
		if (confirm("This will erase all data and completely reset the sprinkler controller!\nProceed?")){
			packet="id=reset";
		}
	}
	else if (command=="SetPassword"){
		if (values[0]!=values[1]){
			alert("Passwords Must Match!");
			return;
		}
		if (!values[2]){
			alert("Timeout Must Be Set\nSet To 0 To Disable");
			return;
		}
		packet="id=setPassword&value="+values[0]+"&timeout="+values[2];
	}
	else if (command=="Update"){
		packet="id=Update&value="+values[0];
	}
	else{
		packet="id="+command;
	}
	var request = new XMLHttpRequest();	
	request.open("POST", "saveData.html", true);
	request.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
	request.onreadystatechange = function () {
		if (this.readyState == 4 && this.status == 200) {
			alert(this.responseText);
		}
	};
	console.log(packet);
	request.send(packet);
}


function qs(...args) {
	var arr = [];
	for (var x = 0; x < args.length; x++) {
		arr = [...arr, ...document.querySelectorAll(args[x])];
	}
	if (arr.length == 1) {
		return arr[0];
	} else {
		return arr;
	}
}

</script>


